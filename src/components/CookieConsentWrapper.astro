---
// Cookie Consent Wrapper component
---

<div id="cookie-consent-wrapper"></div>

<script>
  import CookieConsentModern from '@/components/CookieConsentModern.tsx';
  import { createElement } from 'react';
  import { createRoot } from 'react-dom/client';

  // Wait for DOM to be ready
  document.addEventListener('DOMContentLoaded', () => {
    const container = document.getElementById('cookie-consent-wrapper');
    if (container) {
      const root = createRoot(container);
      
      const handleAcceptAll = () => {
        // Enable all cookies
        if (window.gtag) {
          window.gtag('consent', 'update', {
            analytics_storage: 'granted',
            ad_storage: 'granted'
          });
        }
        console.log('All cookies accepted');
      };
      
      const handleAcceptNecessary = () => {
        // Enable only necessary cookies
        if (window.gtag) {
          window.gtag('consent', 'update', {
            analytics_storage: 'denied',
            ad_storage: 'denied'
          });
        }
        console.log('Only necessary cookies accepted');
      };
      
      const handleSavePreferences = (preferences) => {
        // Apply user preferences
        if (window.gtag) {
          window.gtag('consent', 'update', {
            analytics_storage: preferences.analytics ? 'granted' : 'denied',
            ad_storage: 'denied' // We don't use ad cookies
          });
        }
        console.log('Preferences saved:', preferences);
      };
      
      // Create and render the React component
      const cookieConsentElement = createElement(CookieConsentModern, {
        onAcceptAll: handleAcceptAll,
        onAcceptNecessary: handleAcceptNecessary,
        onSavePreferences: handleSavePreferences
      });
      
      root.render(cookieConsentElement);
    }
  });
</script>
